
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üì° –ö–æ–Ω—Ñ–∏–≥—É—Ä–∏–∫–∏ ‚Äî –ü—Ä–æ–∫—Å–∏ –ö–æ–ª–ª–µ–∫—Ü–∏—è</title>
    <style>
        /* CSS —Å—Ç–∏–ª–∏, –∑–∞–¥–∞—é—â–∏–µ —Å—Ç–∏–ª—å–Ω—ã–π –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π —Ñ–æ–Ω –∏ —Å–∏–º–º–µ—Ç—Ä–∏—é, —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã. */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --secondary-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --dark-bg: #0f172a;
            --card-bg: #1e293b;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --info: #3b82f6;
            --border-radius: 16px;
            --shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
            --transition: all 0.3s ease;
        }

        body {
            background: var(--dark-bg);
            color: var(--text-primary);
            min-height: 100vh;
            padding: 20px;
            background-image: radial-gradient(circle at 20% 30%, rgba(76, 0, 255, 0.1) 0%, transparent 20%),
                              radial-gradient(circle at 80% 70%, rgba(255, 0, 128, 0.1) 0%, transparent 20%);
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px;
            background: var(--primary-gradient);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            position: relative;
            overflow: hidden;
        }

        @keyframes pulse {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        h1 {
            font-size: 3rem;
            margin-bottom: 10px;
            background: linear-gradient(90deg, #ff6b6b, #4ecdc4, #45b7d1, #96ceb4, #feca57);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            background-size: 400% 400%;
            animation: gradient 15s ease infinite;
            position: relative;
        }

        @keyframes gradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .subtitle {
            color: var(--text-secondary);
            font-size: 1.2rem;
            margin-bottom: 30px;
        }

        .controls {
            /* –¢–µ–ø–µ—Ä—å 2 –∫–æ–ª–æ–Ω–∫–∏ –Ω–∞ —à–∏—Ä–æ–∫–æ–º —ç–∫—Ä–∞–Ω–µ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–∏–º–º–µ—Ç—Ä–∏–∏ */
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .control-card {
            background: var(--card-bg);
            padding: 25px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            transition: var(--transition);
        }

        .control-card h3 {
            margin-bottom: 20px;
            color: #60a5fa;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .protocol-filters {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }

        .protocol-filter.active {
            background: var(--primary-gradient);
            color: white;
            border-color: transparent;
        }

        button {
            padding: 14px 28px;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            width: 100%;
            font-size: 1rem;
        }
        
        .btn-primary { background: var(--primary-gradient); color: white; }
        .btn-secondary { background: var(--secondary-gradient); color: white; }
        .btn-danger { background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white; }
        .btn-small { padding: 8px 16px; font-size: 0.9rem; width: auto; }


        .status-bar {
            background: var(--card-bg);
            padding: 20px;
            border-radius: var(--border-radius);
            margin-bottom: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
            box-shadow: var(--shadow);
        }

        .stats {
            display: flex;
            gap: 30px;
            flex-wrap: wrap;
        }
        
        .protocol-groups-container {
            display: flex;
            flex-direction: column;
            gap: 40px; 
        }
        
        .protocol-group {
            background: rgba(30, 41, 59, 0.5); 
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: 0 0 30px rgba(0, 0, 0, 0.2);
        }

        .protocol-group h2 {
            font-size: 1.8rem;
            margin-bottom: 20px;
            color: var(--text-primary);
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }
        
        .protocol-group h2.ss { color: #667eea; }
        .protocol-group h2.trojan { color: #f5576c; }
        .protocol-group h2.vless { color: #4ecdc4; }
        .protocol-group h2.hy2 { color: #ffa751; }

        .group-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 20px; 
        }

        .proxy-card {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 20px; 
            box-shadow: var(--shadow);
            transition: var(--transition);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .info-row {
            display: flex;
            justify-content: space-between;
        }
        
        .proxy-actions {
            display: flex;
            gap: 10px;
        }
        .proxy-actions .btn-small {
            flex-grow: 1; 
        }


        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/material-design-iconic-font/2.2.0/css/material-design-iconic-font.min.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>üì° –ö–æ–Ω—Ñ–∏–≥—É—Ä–∏–∫–∏</h1>
            <div class="subtitle">–≠–ª–∏—Ç–Ω–∞—è –∫–æ–ª–ª–µ–∫—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö –ø—Ä–æ–∫—Å–∏-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π</div>
            <div class="subtitle">–í—Å–µ–≥–æ –∫–æ–Ω—Ñ–∏–≥–æ–≤: <span id="totalCount">0</span> | –ê–∫—Ç–∏–≤–Ω—ã—Ö: <span id="activeCount">0</span></div>
        </header>

        <div class="controls">
            <div class="control-card">
                <h3><i class="zmdi zmdi-filter-list"></i> –§–∏–ª—å—Ç—Ä—ã</h3>
                <div class="protocol-filters" id="protocolFilters">
                    <div class="protocol-filter active" data-protocol="all">–í—Å–µ</div>
                    <div class="protocol-filter" data-protocol="ss">Shadowsocks</div>
                    <div class="protocol-filter" data-protocol="trojan">Trojan</div>
                    <div class="protocol-filter" data-protocol="vless">VLESS</div>
                    <div class="protocol-filter" data-protocol="hy2">Hysteria2</div>
                </div>
                <button class="btn-secondary" onclick="sortByPing()">
                    <i class="zmdi zmdi-sort"></i> –°–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ –ø–∏–Ω–≥—É
                </button>
            </div>

            <div class="control-card">
                <h3><i class="zmdi zmdi-refresh"></i> –ü—Ä–æ–≤–µ—Ä–∫–∞</h3>
                <button class="btn-primary" onclick="checkAllPings()">
                    <i class="zmdi zmdi-check-all"></i> –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ –ø–∏–Ω–≥–∏
                </button>
            </div>

            <!-- –£–ü–†–ê–í–õ–ï–ù–ò–ï: –ö–∞—Ä—Ç–æ—á–∫–∞ —É–¥–∞–ª–µ–Ω–∞, –æ—Å—Ç–∞–≤–ª–µ–Ω–æ —Ç–æ–ª—å–∫–æ –≠–∫—Å–ø–æ—Ä—Ç –≤ status-bar, —Ç.–∫. –æ—á–∏—Å—Ç–∫–∞ –Ω–µ –Ω—É–∂–Ω–∞ -->
            
        </div>

        <div class="status-bar">
            <div class="stats">
                <div class="stat-item">
                    <div class="stat-value" id="pingCount">0</div>
                    <div class="stat-label">–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ –ø–∏–Ω–≥–æ–≤</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="avgPing">-</div>
                    <div class="stat-label">–°—Ä–µ–¥–Ω–∏–π –ø–∏–Ω–≥</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="fastestPing">‚àû</div>
                    <div class="stat-label">–õ—É—á—à–∏–π –ø–∏–Ω–≥</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="countriesCount">0</div>
                    <div class="stat-label">–°—Ç—Ä–∞–Ω</div>
                </div>
            </div>
            <div>
                <button class="btn-small btn-primary" onclick="exportConfigs()">
                    <i class="zmdi zmdi-download"></i> –≠–∫—Å–ø–æ—Ä—Ç
                </button>
            </div>
        </div>

        <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –ø—Ä–æ—Ç–æ–∫–æ–ª—å–Ω—ã—Ö –≥—Ä—É–ø–ø -->
        <div class="protocol-groups-container" id="protocolGroupsContainer">
            <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –ø—Ä–æ—Ç–æ–∫–æ–ª—å–Ω—ã–µ –±–ª–æ–∫–∏ -->
        </div>
    </div>

    <script>
        // –ò—Å—Ö–æ–¥–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π –≤ –ø–∞–º—è—Ç–∏ (–±–µ–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è)
        let proxyConfigs = [
            // Shadowsocks
            {name: "VPN ss nl 1", link: "ss://Y2hhY2hhMjAtaWV0Zi1wb2x5MTMwNToxN1pET1JXSWxpUUh1TzZXUkdIQ2hYWU16ZFJ0QVlWUA@45.14.245.2:443#VPN%20ss%20nl%201", protocol: "ss", country: "nl", ping: null, checked: false},
            {name: "VPN ss hr 2", link: "ss://Y2hhY2hhMjAtaWV0Zi1wb2x5MTMwNTpnWE9YazJGSndzejlQNm5YSUlDdUROT3FGOWdXWDFkbg@185.156.110.92:443#VPN%20ss%20hr%202", protocol: "ss", country: "hr", ping: null, checked: false},
            {name: "VPN ss ru 3", link: "ss://Y2hhY2hhMjAtaWV0Zi1wb2x5MTMwNTpxRkFKZEJFcXNJNzFqYVNNTDY3bkhvUEJDR2hYOTR1aw@45.138.157.162:443#VPN%20ss%20ru%203", protocol: "ss", country: "ru", ping: null, checked: false},
            {name: "VPN ss pt 4", link: "ss://Y2hhY2hhMjAtaWV0Zi1wb2x5MTMwNTpueGdzbUhrUDNKVTdoYlFrSmZ4Z3BYaDV0bHZYZTFlbg@45.83.142.237:443#VPN%20ss%20pt%204", protocol: "ss", country: "pt", ping: null, checked: false},
            {name: "VPN ss us 5", link: "ss://Y2hhY2hhMjAtaWV0Zi1wb2x5MTMwNTpORFJ5U0lBQkFSYkVyTklWc0NOVmt5WUFIaUJ6aHZlVA@23.95.75.146:443#VPN%20ss%20us%205", protocol: "ss", country: "us", ping: null, checked: false},
            {name: "VPN ss jp 6 ‚ôøÔ∏è", link: "ss://Y2hhY2hhMjAtaWV0Zi1wb2x5MTMwNTp4Z29Pc3l5QnYyWW40dzhoU3Fqc05xZjVJR2JJRVRaNg@5.253.41.46:443#VPN%20ss%20jp%206%20‚ôøÔ∏è", protocol: "ss", country: "jp", ping: null, checked: false, disabled: true},

            // Trojan
            {name: "VPN trojan de 1", link: "trojan://M7v%25w11Se%2A@35.246.185.109:443?sni=dggg.wsone.icu#VPN%20trojan%20de%201", protocol: "trojan", country: "de", ping: null, checked: false},
            {name: "VPN trojan us 2 ‚ôøÔ∏è", link: "trojan://M7v%25w11Se%2A@34.94.125.227:443?sni=mxlo.wsone.icu#VPN%20trojan%20us%202%20‚ôøÔ∏è", protocol: "trojan", country: "us", ping: null, checked: false, disabled: true},
            {name: "VPN trojan nz 3 ‚ôøÔ∏è", link: "trojan://tSk5LQoJr7F.WnRsUM4hT@45.15.140.107:19106?sni=binaryboots.algorithmblanket.click#VPN%20trojan%20nz%203%20‚ôøÔ∏è", protocol: "trojan", country: "nz", ping: null, checked: false, disabled: true},
            {name: "VPN trojan no 4", link: "trojan://DGVu0fnAmdPMx7F9Reo.s@217.170.194.222:13950?allowInsecure=1&sni=ads.x5.ru#VPN%20trojan%20no%204", protocol: "trojan", country: "no", ping: null, checked: false},

            // Hysteria2
            {name: "VPN hy2 nl 1", link: "hysteria2://Telegram--%3E%40Ln2Ray@206.71.158.23:45000/?insecure=1&obfs=salamander&obfs-password=Telegram--%3E%40Ln2Ray&sni=gavazn.55994421.xyz#VPN%20hy2%20nl%201", protocol: "hy2", country: "nl", ping: null, checked: false},
            {name: "VPN hy2 nl 2", link: "hysteria2://Yet-Another-Public-Config-1@206.71.158.37:36400/?insecure=1&obfs=salamander&obfs-password=Yet-Another-Public-Config-1&sni=YAPC-1.afshin.ir#VPN%20hy2%20nl%202", protocol: "hy2", country: "nl", ping: null, checked: false},
            {name: "VPN hy2 jp 3", link: "hysteria2://Telegram--%3E%40Ln2Ray@gavazn.lnmarketplace.net:45000/?insecure=1&obfs=salamander&obfs-password=Telegram--%3E%40Ln2Ray&sni=gavazn.55994421.xyz#VPN%20hy2%20jp%203", protocol: "hy2", country: "jp", ping: null, checked: false},

            // VLESS
            {name: "VPN vless de 1", link: "vless://7c63f43f-f526-49bb-b5c8-2be26e11ef00@181.214.231.8:443?alpn=h2&encryption=none&host=181.214.231.8&mode=stream-one&path=%2Fstatue&security=tls&sni=statue.lnmarketplace.net&type=xhttp#VPN%20vless%20de%201", protocol: "vless", country: "de", ping: null, checked: false},
            {name: "VPN vless ru 2", link: "vless://ce13ec9d-0f04-49c0-9877-0e7d1e657895@a.ru.maviks.ru:443?encryption=none&flow=xtls-rprx-vision&fp=chrome&pbk=cGzNRbN_zruI3CVTDukB2nOqWWEj7kgkay24f2fdLmQ&security=reality&sid=0f917152a871e9c0&sni=maviks.ru&type=tcp#VPN%20vless%20ru%202", protocol: "vless", country: "ru", ping: null, checked: false},
            {name: "VPN vless at 3", link: "vless://86c50e3a-5b87-49dd-bd20-03c7f2735e40@www.wto.org:2095?encryption=none&host=freedom.pusytroller.cf&path=%2F&security=none&type=ws#VPN%20vless%20at%203", protocol: "vless", country: "at", ping: null, checked: false},
            {name: "VPN vless fi 4 ‚ôøÔ∏è", link: "vless://c2e196d4-3453-4c6c-bb80-fe372801e1a0@62.60.237.26:443?encryption=none&flow=xtls-rprx-vision&fp=chrome&pbk=lmLFxJO0l6GlHhi3a4I6cKWdQLDo-f8ciODP0xh3EXQ&security=reality&sid=9d36b8589fa524fd&sni=st.ozone.ru&type=tcp#VPN%20vless%20fi%204%20‚ôøÔ∏è", protocol: "vless", country: "fi", ping: null, checked: false, disabled: true},
            {name: "VPN vless uk 5 ‚ôøÔ∏è", link: "vless://bf3e8944-8d26-47de-8748-b9aa74cce974@140.238.100.35:40721?encryption=none&fp=chrome&pbk=TUZgwzcTvoROSbgnqMh3WorXVMxQNIF2zsEM39FQbyk&security=reality&sid=df8611c07d&sni=yahoo.com&type=tcp#VPN%20vless%20uk%205%20‚ôøÔ∏è", protocol: "vless", country: "uk", ping: null, checked: false, disabled: true},
            {name: "VPN vless ru (test vless 1)", link: "vless://7fc953d6-ae75-46fb-a970-10b57d513487@45.139.26.152:7443?encryption=none&flow=xtls-rprx-vision&fp=chrome&pbk=BTkKaFt2xac4xAHn3EXrBKV0d8ItHSfciMFnxg57BGA&security=reality&sid=fd88bd27db4cc661&sni=eh.vk.com&type=tcp#VPN%20vless%20ru%20(test%20vless%201)", protocol: "vless", country: "ru", ping: null, checked: false, test: true},
            {name: "VPN vless nl (test vless 2)", link: "vless://8fe5889f-bc41-40d6-a93e-fa98e1527a29@144.31.105.21:443?encryption=none&fp=chrome&host=googlevideo.com&mode=auto&path=%2F&pbk=3RCgyYQ27hlOjASSG8dTvEjlwia05DV5RmsRn5TjpEo&security=reality&sid=41701282228f4cff&sni=google.com&type=xhttp#VPN%20vless%20nl%20(test%20vless%202)", protocol: "vless", country: "nl", ping: null, checked: false, test: true}
        ];

        const countryNames = {
            nl: "–ù–∏–¥–µ—Ä–ª–∞–Ω–¥—ã", hr: "–•–æ—Ä–≤–∞—Ç–∏—è", ru: "–†–æ—Å—Å–∏—è", pt: "–ü–æ—Ä—Ç—É–≥–∞–ª–∏—è", us: "–°–®–ê", jp: "–Ø–ø–æ–Ω–∏—è",
            de: "–ì–µ—Ä–º–∞–Ω–∏—è", nz: "–ù–æ–≤–∞—è –ó–µ–ª–∞–Ω–¥–∏—è", no: "–ù–æ—Ä–≤–µ–≥–∏—è", at: "–ê–≤—Å—Ç—Ä–∏—è", fi: "–§–∏–Ω–ª—è–Ω–¥–∏—è", uk: "–í–µ–ª–∏–∫–æ–±—Ä–∏—Ç–∞–Ω–∏—è", xx: "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"
        };
        const protocolTitles = {
            ss: "Shadowsocks (SS)",
            trojan: "Trojan",
            vless: "VLESS",
            hy2: "Hysteria2"
        };
        const knownProtocols = ['ss', 'trojan', 'hy2', 'vless'];

        let currentFilter = 'all';
        let isChecking = false;

        
        // –ü–µ—Ä–µ—Ä–∞–±–æ—Ç–∞–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ —Å –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–æ–π –ø–æ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞–º
        function renderList() {
            const container = document.getElementById('protocolGroupsContainer');
            container.innerHTML = '';
            
            let filteredConfigs = proxyConfigs;
            if (currentFilter !== 'all') {
                 filteredConfigs = proxyConfigs.filter(config => config.protocol === currentFilter);
            }
            
            const groups = filteredConfigs.reduce((acc, config) => {
                const proto = config.protocol;
                if (!acc[proto]) {
                    acc[proto] = [];
                }
                acc[proto].push(config);
                return acc;
            }, {});

            const displayProtocols = currentFilter !== 'all' ? [currentFilter] : knownProtocols;

            displayProtocols.forEach(proto => {
                const configsInGroup = groups[proto];
                if (!configsInGroup || configsInGroup.length === 0) return;

                const groupHtml = `
                    <div class="protocol-group">
                        <h2 class="${proto}">${protocolTitles[proto] || proto.toUpperCase()} ‚Äî ${configsInGroup.length} —à—Ç.</h2>
                        <div class="group-list">
                            ${configsInGroup.map(config => `
                                <div class="proxy-card ${config.disabled ? 'disabled' : ''} ${config.test ? 'test' : ''}">
                                    <div class="proxy-header">
                                        <div class="proxy-name">${config.name}</div>
                                        <div class="protocol-badge protocol-${config.protocol}">
                                            ${config.protocol.toUpperCase()}
                                        </div>
                                    </div>
                                    
                                    <div class="proxy-info">
                                        <div class="info-row">
                                            <span class="info-label">–°—Ç—Ä–∞–Ω–∞:</span>
                                            <span class="info-value">${countryNames[config.country] || config.country} (${config.country.toUpperCase()})</span>
                                        </div>
                                        <div class="info-row">
                                            <span class="info-label">–ü–∏–Ω–≥:</span>
                                            <span class="info-value" id="ping-${config.name}">
                                                ${config.ping !== null ? `${config.ping} –º—Å` : '–ù–µ –ø—Ä–æ–≤–µ—Ä–µ–Ω'}
                                            </span>
                                        </div>
                                        
                                        ${config.ping !== null ? `
                                        <div class="ping-indicator">
                                            <div class="ping-bar ${getPingClass(config.ping)}" style="width: ${Math.min(100, (500 / config.ping) * 100) || 0}%"></div>
                                        </div>` : ''}
                                    </div>
                                    
                                    <div class="proxy-actions">
                                        <!-- –ö–Ω–æ–ø–∫–∏ –≤ –ª–∏–Ω–∏—é -->
                                        <button class="btn-small btn-primary" onclick="copyToClipboard('${config.link}')">
                                            <i class="zmdi zmdi-copy"></i> –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
                                        </button>
                                        <button class="btn-small btn-secondary" onclick="checkPing('${config.name}', event)">
                                            <i class="zmdi zmdi-time"></i> –ü–∏–Ω–≥
                                        </button>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
                container.insertAdjacentHTML('beforeend', groupHtml);
            });


            document.getElementById('totalCount').textContent = proxyConfigs.length;
            document.getElementById('activeCount').textContent = proxyConfigs.filter(c => !c.disabled).length;
        }


        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∏–Ω–≥–∞ —á–µ—Ä–µ–∑ google.com/generate_204 (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –ª–æ–≥–∏–∫–∞ RTT)
        async function checkPing(configName, event) {
            const config = proxyConfigs.find(c => c.name === configName);
            if (!config) return;

            const pingElement = document.getElementById(`ping-${config.name}`);
            const button = event ? event.target : null;

            const originalButtonText = button ? button.innerHTML : null;
            if (button) button.innerHTML = '<span class="loading"></span> –ü–∏–Ω–≥...';
            if(pingElement) pingElement.textContent = '–ò–∑–º–µ—Ä–µ–Ω–∏–µ...';

            try {
                const start = performance.now();
                await fetch('https://www.google.com/generate_204', { 
                    method: 'HEAD', 
                    cache: 'no-store',
                    mode: 'no-cors' 
                });
                const end = performance.now();
                
                const ping = Math.round(end - start);
                config.ping = ping;
                if(pingElement) pingElement.textContent = `${ping} –º—Å`;
                
                updateStats();
                renderList();
            } catch (error) {
                config.ping = null; 
                if(pingElement) pingElement.textContent = '–û—à–∏–±–∫–∞';
                
                updateStats();
                renderList(); 
            } finally {
                if (button) button.innerHTML = originalButtonText;
            }
        }
        
        // –ú–∞—Å—Å–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–∏–Ω–≥–æ–≤
        async function checkAllPings(event) {
            if (isChecking) return;
            isChecking = true;
            
            const btn = event?.target;
            const originalText = btn?.innerHTML;
            if (btn) btn.innerHTML = '<span class="loading"></span> –ü—Ä–æ–≤–µ—Ä–∫–∞...';
            
            let checkedCount = 0;
            const configsToProcess = [...proxyConfigs];

            for (const config of configsToProcess) {
                await checkPing(config.name); 
                checkedCount++;
                document.getElementById('pingCount').textContent = checkedCount;
                await new Promise(resolve => setTimeout(resolve, 300));
            }
            
            if (btn) btn.innerHTML = originalText;
            isChecking = false;
        }
        
        // –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –ø–∏–Ω–≥—É
        function sortByPing() {
            proxyConfigs.sort((a, b) => {
                if (a.ping === null && b.ping === null) return 0;
                if (a.ping === null) return 1;
                if (b.ping === null) return -1;
                return a.ping - b.ping;
            });
            renderList();
        }

        // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –ø—Ä–æ—Ç–æ–∫–æ–ª—É
        document.querySelectorAll('.protocol-filter').forEach(filter => {
            filter.addEventListener('click', (e) => {
                document.querySelectorAll('.protocol-filter').forEach(f => f.classList.remove('active'));
                e.currentTarget.classList.add('active');
                currentFilter = e.currentTarget.dataset.protocol;
                renderList();
            });
        });

        // –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –±—É—Ñ–µ—Ä
        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                const notification = document.getElementById('copyNotification');
                notification.classList.add('show');
                setTimeout(() => notification.classList.remove('show'), 2000);
            });
        }
        
        // –§—É–Ω–∫—Ü–∏–∏ addConfig, removeConfig, clearAllData - —É–¥–∞–ª–µ–Ω—ã –ø–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é.

        // –≠–∫—Å–ø–æ—Ä—Ç –∫–æ–Ω—Ñ–∏–≥–æ–≤
        function exportConfigs() {
            const configText = proxyConfigs.map(c => c.link).join('\n\n');
            const blob = new Blob([configText], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'configuriki-' + new Date().toISOString().split('T')[0] + '.txt';
            a.click();
            URL.revokeObjectURL(url);
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        function updateStats() {
            const validPings = proxyConfigs.filter(c => c.ping !== null).map(c => c.ping);
            const pingCount = validPings.length;
            const avgPing = pingCount > 0 ? Math.round(validPings.reduce((a, b) => a + b) / pingCount) : 0;
            const fastestPing = pingCount > 0 ? Math.min(...validPings) : Infinity;
            
            const countries = new Set(proxyConfigs.map(c => c.country)).size;
            
            document.getElementById('pingCount').textContent = pingCount;
            document.getElementById('avgPing').textContent = avgPing > 0 ? `${avgPing} –º—Å` : '-';
            document.getElementById('fastestPing').textContent = fastestPing < Infinity ? `${fastestPing} –º—Å` : '‚àû';
            
            document.getElementById('countriesCount').textContent = countries > 0 && proxyConfigs.some(c => c.country === 'xx') ? countries - 1 : countries;
        }

        // –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–∏–Ω–≥–∞ –ø–æ —Ü–≤–µ—Ç—É
        function getPingClass(ping) {
            if (ping === null) return 'ping-poor'; 
            if (ping < 100) return 'ping-excellent';
            if (ping < 200) return 'ping-good';
            if (ping < 500) return 'ping-medium';
            return 'ping-poor';
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', () => {
            renderList();
            updateStats();
            setTimeout(() => checkAllPings(), 1000);
        });
    </script>
</body>
</html>
